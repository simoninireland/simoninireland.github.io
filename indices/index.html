<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simon Dobson</title>
<style>
	@font-face {
	    font-family: "libretto-icons";
	    src:url(../assets/fonts/libretto-icons.eot);
	    src:url(../assets/fonts/libretto-icons.eot#iefix) format("embedded-opentype"),
	    url(../assets/fonts/libretto-icons.woff) format("woff"),
	    url(../assets/fonts/libretto-icons.ttf) format("truetype"),
	    url(../assets/fonts/libretto-icons.svg#libretto-icons) format("svg");
	    font-weight: normal;
	    font-style: normal;
	}
    </style>
<link rel="icon" href="../images/favicon.png" sizes="16x16">
<link rel="alternate" type="application/rss+xml" href="../rss.xml">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Sans+Mono|Libre+Baskerville|Montserrat|Playfair+Display|Tangerine">
<link rel="stylesheet" href="../assets/css/libretto_styles.css">
<link rel="stylesheet" href="../assets/css/baguetteBox.min.css">
<link rel="stylesheet" href="../assets/css/code.css">
<link rel="stylesheet" href="../assets/css/nikola_rst.css">
<link rel="stylesheet" href="../assets/css/nikola_ipython.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
</head>
<body>
    <!-- Navigation bar -->
    <header class="nav-bar"><div class="site-branding">
	    <h1 class="site-title">
		<a href="https://simondobson.org/" title="Simon Dobson" rel="home">Simon&nbsp;Dobson</a>
	    </h1>
	</div>
	<nav class="site-navigation" role="navigation"><div class="menu-toggle">
		<span class="mobile-site-title">Simon Dobson</span>
	    </div>
	    <ul class="menu">
<li><a href="../index.html">Home</a></li>
		    <li><a href="../personal/">About&nbsp;me</a></li>
		    <li><a href="../research/">Research</a></li>
		    <li><a href="../development/projects/">Software</a></li>
		    <li><a href="../writing/">Writing</a></li>
		    <li><a href="../personal/contact/">Contact</a></li>
		<li>
<a href="../rss.xml"><i class="fa fa-rss"></i></a>
	    </li>
</ul></nav></header><div class="site-content">
	    <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
		    <div class="entry-meta">
			<span class="posted-on">
			    Posted on <a href="../2024/11/29/new-release-of-epydemic/" rel="bookmark">Friday 29 November, 2024</a>
			</span>
		    </div>
		    <h1><a href="../2024/11/29/new-release-of-epydemic/">New release of&nbsp;epydemic</a></h1>
		</div>
		<div class="entry-content">
			<div id="outline-container-org7aa5b80" class="outline-2">
<h2 id="org7aa5b80">New release of&nbsp;epydemic</h2>
<div class="outline-text-2" id="text-org7aa5b80">
<p>
It&#8217;s been a while – about 15 months since v.1.13.1 – but today I
finally released v.1.14.1&nbsp;of <code>epydemic</code>, a library for epidemic (and)
other simulation over complex&nbsp;networks.
</p>

<p>
This release include several bug-fixes and two major&nbsp;changes.
</p>
</div>

<div id="outline-container-org998dee1" class="outline-3">
<h3 id="org998dee1">Better Newman-Ziff&nbsp;percolation</h3>
<div class="outline-text-3" id="text-org998dee1">
<p>
The Newman-Ziff algorithm for bond and site percolation is widely
used. The version that&#8217;s been&nbsp;in <code>epydemic</code> for a while emphasise
speed over everything. However, in the course of some work by one
of my MSc students on how grids of different dimensions respond to
random failure, we discovered that we needed to be able to do some
more flexible operations. In particular, we wanted to sample things
other than just the size of the largest connected component, and
wanted to be able to dig into to exactly how the network was&nbsp;deforming.
</p>

<p>
The problem was that this information wasn&#8217;t readily available. It
<i>was</i> encoded within the algorithm&#8217;s data structure, but it wasn&#8217;t
being reflected as an evolving network that was easy to get at. So
we upgraded the algorithm to build a working copy of the network as
it was constructed, so that it could be interrogated by&nbsp;normal <code>networkx</code> operations within the sampling process. This adds
some time penalty, but it&#8217;s acceptable slowdown for the extra&nbsp;capability.
</p>
</div>
</div>

<div id="outline-container-org8635453" class="outline-3">
<h3 id="org8635453">Multiple process&nbsp;instances</h3>
<div class="outline-text-3" id="text-org8635453">
<p>
<code>epydemic</code> defines different epidemic processes (and indeed
non-disease processes like pulse-coupled oscillators). Until now
these have been usable alone in a simulation, but not together: one
couldn&#8217;t run <i>two</i> diseases in the <i>same</i> simulation over the <i>same</i>
population simultaneously. Doing so is obviously very desirable,
especially if you want to explore co-infecting&nbsp;diseases.
</p>

<p>
Co-infection is a difficult problem. As a first step we&#8217;ve added
multiple process instances which can have their own parameters and
results – or can share parameters if required. This involves
assigning distinct names to each instance, and then optionally
using them to decorate parameter/result&nbsp;names.
</p>

<p>
This is fiddly if done manually, so we also added some methods on&nbsp;the <code>Process</code> class to get and set parameters and results using any
instance name on the calling process. For&nbsp;example:
</p>

<div class="highlight"><pre><span></span>   <span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

   <span class="c1"># network</span>
   <span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
   <span class="n">kmean</span> <span class="o">=</span> <span class="mi">100</span>
   <span class="n">params</span><span class="p">[</span><span class="n">ERNetwork</span><span class="o">.</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span>
   <span class="n">params</span><span class="p">[</span><span class="n">ERNetwork</span><span class="o">.</span><span class="n">KMEAN</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmean</span>

   <span class="c1"># first infection</span>
   <span class="n">p1</span> <span class="o">=</span> <span class="n">SIR</span><span class="p">(</span><span class="s2">"Disease1"</span><span class="p">)</span>
   <span class="n">p1</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">params</span><span class="p">,</span>
                    <span class="p">{</span><span class="n">SIR</span><span class="o">.</span><span class="n">P_INFECT</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                     <span class="n">SIR</span><span class="o">.</span><span class="n">P_INFECTED</span><span class="p">:</span> <span class="mf">5.0</span> <span class="o">/</span> <span class="n">N</span>
                     <span class="p">})</span>

   <span class="c1"># second infection</span>
   <span class="n">p2</span> <span class="o">=</span> <span class="n">SIR</span><span class="p">(</span><span class="s2">"Disease2"</span><span class="p">)</span>
   <span class="n">p2</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">params</span><span class="p">,</span>
                    <span class="p">{</span><span class="n">SIR</span><span class="o">.</span><span class="n">P_INFECT</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
                     <span class="n">SIR</span><span class="o">.</span><span class="n">P_INFECTED</span><span class="p">:</span> <span class="mf">5.0</span> <span class="o">/</span> <span class="n">N</span>
                     <span class="p">})</span>

   <span class="c1"># common removal rate</span>
   <span class="n">params</span><span class="p">[</span><span class="n">SIR</span><span class="o">.</span><span class="n">P_REMOVE</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.005</span>

   <span class="c1"># run the processes together</span>
   <span class="n">ps</span> <span class="o">=</span> <span class="n">ProcessSequence</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">])</span>
   <span class="n">e</span> <span class="o">=</span> <span class="n">StochasticDynamics</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">ERNetwork</span><span class="p">())</span>
   <span class="n">rc</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fatal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

<p>
The <code>setParameters</code> call sets the parameters decorated with the name
of the process, if it has one. There are other operations for
extracting the parameters, and for interacting with experimental
results without getting into the details of&nbsp;decoration.
</p>

<p>
See <a href="https://pypi.org/project/epydemic/">the project documentation</a> for more details, as well as an
updated tutorial and a cookbook recipe for co-infection (which is
based around the code above). The <a href="https://github.com/simoninireland/epydemic">Github repo</a> is also available. To
upgrade, just&nbsp;run:
</p>

<div class="highlight"><pre><span></span>   <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">epydemic</span>
</pre></div>

<p>
or delete and re-build any virtual&nbsp;environments.
</p>
</div>
</div>
</div>
		</div>
	    </article>
</div>
	<div class="site-content">
	    <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
		    <div class="entry-meta">
			<span class="posted-on">
			    Posted on <a href="../2024/11/29/lisp-as-a-second-language/" rel="bookmark">Friday 29 November, 2024</a>
			</span>
		    </div>
		    <h1><a href="../2024/11/29/lisp-as-a-second-language/">Lisp as a second&nbsp;language</a></h1>
		</div>
		<div class="entry-content">
			<div id="outline-container-org0936ec5" class="outline-2">
<h2 id="org0936ec5">Lisp as a second&nbsp;language</h2>
<div class="outline-text-2" id="text-org0936ec5">
<p>
Peter Desain.  <i><a href="https://hdl.handle.net/2066/74778">Lisp as a Second Language: Functional Aspects</a></i>.
Perspectives on New Music <b>20</b>, pp.192–222.&nbsp;1990.
</p>

<p>
In some ways this article should come under &#8220;applications&#8221;, as
it&#8217;s mainly concerned with using Lisp to represent and manipulate
music. Indeed, it presents a system that can be used to perform
all sorts of common transformations of the tones and timing of a
piece. It&#8217;s easy to see how the resulting system could be used to
compose and then to drive instruments, for example through a <span class="caps">MIDI</span>&nbsp;interface.
</p>

<p>
The music perspective is however secondary to the goal of teaching
and showcasing Lisp through the medium of a realistic example of
symbolic programming. It covers a lot of ground, starting with
lists and functions and including first-class functions and
combinators as means of implementing the musical structures. It&#8217;s
a great piece of pedagogy that treats the application and the
language as closely linked, and not shying-away from some quite
advanced techniques that have clear applications in the domain. It
would be great to see this used as a basis for actual musical
composition and&nbsp;performance.
</p>
</div>
</div>
		</div>
	    </article>
</div>
	<div class="site-content">
	    <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
		    <div class="entry-meta">
			<span class="posted-on">
			    Posted on <a href="../2024/10/18/two-lisp-compilers-written-in-lisp/" rel="bookmark">Friday 18 October, 2024</a>
			</span>
		    </div>
		    <h1><a href="../2024/10/18/two-lisp-compilers-written-in-lisp/">Two Lisp compilers written in&nbsp;Lisp</a></h1>
		</div>
		<div class="entry-content">
			<div id="outline-container-orgc407bcc" class="outline-2">
<h2 id="orgc407bcc">Two Lisp compilers written in&nbsp;Lisp</h2>
<div class="outline-text-2" id="text-orgc407bcc">
<p>
<a href="http://www.ulisp.com/show?4W2I">A Lisp compiler to <span class="caps">ARM</span> written in&nbsp;Lisp</a>
</p>

<p>
<a href="http://www.ulisp.com/show?4Y20=">A Lisp compiler to <span class="caps">RISC</span>-V written in&nbsp;Lisp</a>
</p>

<p>
Two native-code compilers written in the <a href="http://www.ulisp.com/show?3J">uLisp</a> dialect that targets
microcontroller-class machines. Both use a combination of stack
and register allocation to get efficiency – and they&#8217;re <i>very</i>
efficient, with the compiled versions sometimes being 100x faster
than the interpreted&nbsp;code.
</p>

<p>
These are not complete ports, and indeed not on a complete or
standard underlying Lisp implementation. But it&#8217;s still fascinating
to see how <i>simple</i> it is, built as a recursive-descent tree-walker
that emits assembler directly. With careful initial design even a
compiler with no optimisation pathways can still get great speed-up
over an&nbsp;interpreter.
</p>
</div>
</div>
		</div>
	    </article>
</div>
	<div class="site-content">
	    <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
		    <div class="entry-meta">
			<span class="posted-on">
			    Posted on <a href="../2024/09/27/the-different-energy-footprints-of-different-programming-languages/" rel="bookmark">Friday 27 September, 2024</a>
			</span>
		    </div>
		    <h1><a href="../2024/09/27/the-different-energy-footprints-of-different-programming-languages/">The different energy footprints of different programming&nbsp;languages</a></h1>
		</div>
		<div class="entry-content">
			<div id="outline-container-org37bf54e" class="outline-2">
<h2 id="org37bf54e">The different energy footprints of different programming&nbsp;languages</h2>
<div class="outline-text-2" id="text-org37bf54e">
<p>
I&#8217;ve recently been thinking about low-power computing, from <span class="caps">AI</span> and
data centres down to sensors, as part of a new initiative the
University is considering. It&#8217;s easy to forget the resource
footprint of our computing systems – especially those that are &#8220;out
of sight, out of mind&#8221; in the cloud – but there&#8217;s growing evidence
that their growth threatens the renewable energy transition. Some of
the figures for <span class="caps">AI</span> electricity and water usage are&nbsp;astonishing.
</p>

<p>
One aspect of this is the effect of choice of programming language.
I can across some work from 2017 on&nbsp;this:
</p>

<p>
Rui Pereira, Marco Couto, Francisco Ribeiro, Rui Rua, Cunha Jácome,
João Paulo Fernandes, and João Saraiva. <i><a href="https://doi.org/10.1145/3136014.3136031">Energy Efficiency across
Programming Languages: How Do Energy, Time, and Memory Relate?</a></i> In
<i>Proceedings of the 10th <span class="caps">ACM</span> <span class="caps">SIGPLAN</span> International Conference on
Software Language Engineering</i>.&nbsp;2017.
</p>

<p>
The authors compare 13 benchmarks run in 27 different languages,
with the benchmarks being chosen widely to avoid being biased by
numeric performance. I was expecting some patterns: compiled
languages doing better on performance, memory, and energy usage, for
example. But I wasn&#8217;t expecting exactly <i>how</i> widely the figures
diverged, or some of the&nbsp;details.
</p>

<p>
The following table is from the paper, annotated by me. The figures
are normalised against the best result in each category (so the top
language has value 1, and so&nbsp;on).
</p>

<p width="80%" align="center">
<img src="../attachments/fb/debea0-0913-41c2-90bc-726153de8d28/pl-energy.png" alt="pl-energy.png"></p>

<p>
The two most-used languages for web application, Python and
JavaScript, perform uniformly pretty badly: 75 times C&#8217;s energy
usage, in Python&#8217;s case. But although JavaScript does substantially
better on energy (only a factor of 4), TypeScript – which is
usually thought of as JavaScript with type pre-processing –
requires 21 times C&#8217;s energy, or 5 times JavaScript&#8217;s. Why is that?
– I can&#8217;t think of a&nbsp;reason.
</p>

<p>
But the real surprise was that &#8220;research&#8221; languages like Haskell and
Lisp both hold up well: twice C&#8217;s energy, in Lisp&#8217;s case. I don&#8217;t
think that would surprise modern Lisp programmers, who are used to
their compilers&#8217; efficiencies – but it would surprise someone used
only to the &#8220;hearsay&#8221; about Lisp. The same for Haskell, actually,
whose modern compilers really leverage the extra structure. When you
consider that both those languages are pretty much dependent on
garbage collection and so are doing substantially <i>more</i> work than the
equivalent C program, it&#8217;s&nbsp;impressive.
</p>

<p>
(Also look in the table for Racket, consistently lower than Lisp
despite their close similarities. I suspect this is a compiler
optimisation issue more than anything&nbsp;else.)
</p>

<p>
This work clearly isn&#8217;t complete or definitive. Clojure is entirely
missing, as is Scala, and there will have been compiler improvements
since 2017 for the languages with the most active developer
communities. But it&#8217;s still quite sobering that the differences are
<i>so</i> wide, and that we&#8217;ve chosen to push languages that exacerbate
energy usage rather than managing&nbsp;it.
</p>
</div>
</div>
		</div>
	    </article>
</div>
	<div class="site-content">
	    <article class="format-standard libretto-long-form"><div class="title-block post-format-icon-pin">
		    <div class="entry-meta">
			<span class="posted-on">
			    Posted on <a href="../2024/09/27/purely-functional-data-structures/" rel="bookmark">Friday 27 September, 2024</a>
			</span>
		    </div>
		    <h1><a href="../2024/09/27/purely-functional-data-structures/">Purely functional data&nbsp;structures</a></h1>
		</div>
		<div class="entry-content">
			<div id="outline-container-orgc478829" class="outline-2">
<h2 id="orgc478829">Purely functional data&nbsp;structures</h2>
<div class="outline-text-2" id="text-orgc478829">
<p>
Chris Okasaki. <i>Purely Functional Data Structures</i>. Cambridge
University Press. <span class="caps">ISBN</span> 978-051153-010-4.&nbsp;1998.
</p>

<p>
Not a Lisp book <i>per se</i>, but a treatment of data structures from a
functional programming perspective. The code examples are in
Standard <span class="caps">ML</span>, but the ideas apply strongly to Lisp and Scheme.
Definitely a useful source for an alternative take on data
structuring that doesn&#8217;t start from assumptions of imperative
programming and&nbsp;mutability.
</p>
</div>
</div>
		</div>
	    </article>
</div>
    <!-- Lower Navigation links -->
    <nav class="site-content navigation-post" role="navigation"><div class="previous">
		<a href="index-151.html" rel="prev">
		    <span class="meta-nav">Older Entries</span>		</a>
	    </div>
    </nav><!-- Page Footer --><section class="footer-sidebar clear" role="complementary"><div class="widget-block">
	    <aside class="widget"><h2 class="widget-title">Simon&nbsp;Dobson</h2>
		<div class="widget-text">Aut tace aut loquere meliora silentio</div>
	    </aside>
</div>
    </section><!-- Extra JavaScript --><!-- Site Attributions --><footer class="site-footer" role="contentinfo"><div class="site-info">
	    <p></p>
	    <p>
	      Built with free and open-source software.
	      Powered by <a href="https://getnikola.com/">Nikola</a> using a theme based on
	      <a href="https://themes.getnikola.com/v7/libretto/">Libretto</a>.
	    </p>
	    <p>
	      All content Copyright © 2010–2024 Simon Dobson and licensed under
	      <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="caps">CC</span>-<span class="caps">BY</span>-<span class="caps">NC</span>-<span class="caps">SA</span>-4.0</a>
	      unless otherwise&nbsp;noted.
	    </p>
	</div>
	<div class="social">
	    <ul class="menu"></ul>
</div>
    </footer>
</body>
</html>